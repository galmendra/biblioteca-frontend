import{a as Y}from"./chunk-GG4VRRQX.js";import{a as H,c as J,d as K}from"./chunk-DFTAQJWK.js";import{C as z,F as W,G as X,b as B,d as u,f as y,g as I,j as q,k as N,l as T,m as D,n as O,p as w,q as G,r as L,s as P,v as V,w as j,x as A,y as R}from"./chunk-XGSNQAZ3.js";import{K as Q,L as U}from"./chunk-YOF6ZWVV.js";import{d as S,f as x}from"./chunk-72KRNO7Q.js";import{$ as d,Fb as b,Gc as v,Kc as F,Pa as a,Vb as i,Wb as C,Xb as M,eb as E,ib as p,tb as m,ub as r,vb as t,wb as c}from"./chunk-PS7QTO7M.js";function Z(o,f){o&1&&(r(0,"mat-error"),i(1," El t\xEDtulo es requerido "),t())}function $(o,f){o&1&&(r(0,"mat-error"),i(1," El autor es requerido "),t())}function ee(o,f){o&1&&(r(0,"mat-error"),i(1," La categor\xEDa es requerida "),t())}function te(o,f){o&1&&(r(0,"mat-error"),i(1," El stock es requerido "),t())}function oe(o,f){o&1&&(r(0,"mat-error"),i(1," El stock debe ser al menos 0 "),t())}var Ce=(()=>{class o{fb=d(O);booksService=d(Y);router=d(x);route=d(S);snackBar=d(W);bookForm;loading=!1;isEditMode=!1;bookId=null;constructor(){this.bookForm=this.fb.group({title:["",u.required],author:["",u.required],category:["",u.required],stock:[0,[u.required,u.min(0)]]})}ngOnInit(){this.bookId=this.route.snapshot.paramMap.get("id"),this.bookId&&(this.isEditMode=!0,this.loadBook())}loadBook(){this.bookId&&this.booksService.getBook(this.bookId).subscribe({next:n=>{n.success&&n.book&&this.bookForm.patchValue(n.book)},error:n=>{this.snackBar.open("Error al cargar el libro","Cerrar",{duration:3e3}),this.router.navigate(["/books"])}})}onSubmit(){if(this.bookForm.valid){this.loading=!0;let n=this.bookForm.value;(this.isEditMode?this.booksService.updateBook(this.bookId,n):this.booksService.createBook(n)).subscribe({next:e=>{this.loading=!1,e.success&&(this.snackBar.open(e.message||(this.isEditMode?"Libro actualizado":"Libro creado"),"Cerrar",{duration:3e3}),this.router.navigate(["/books"]))},error:e=>{this.loading=!1;let l=e.error?.message||"Error al guardar el libro";this.snackBar.open(l,"Cerrar",{duration:3e3})}})}}cancel(){this.router.navigate(["/books"])}static \u0275fac=function(s){return new(s||o)};static \u0275cmp=E({type:o,selectors:[["app-book-form"]],decls:33,vars:9,consts:[[1,"form-container"],[1,"form-card"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","title","placeholder","T\xEDtulo del libro"],[4,"ngIf"],["matInput","","formControlName","author","placeholder","Nombre del autor"],["matInput","","formControlName","category","placeholder","Ej: Novela, Ciencia, etc."],["matInput","","type","number","formControlName","stock","placeholder","0"],[1,"form-actions"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(s,e){if(s&1&&(r(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),i(4),t()(),r(5,"mat-card-content")(6,"form",2),b("ngSubmit",function(){return e.onSubmit()}),r(7,"mat-form-field",3)(8,"mat-label"),i(9,"T\xEDtulo"),t(),c(10,"input",4),p(11,Z,2,0,"mat-error",5),t(),r(12,"mat-form-field",3)(13,"mat-label"),i(14,"Autor"),t(),c(15,"input",6),p(16,$,2,0,"mat-error",5),t(),r(17,"mat-form-field",3)(18,"mat-label"),i(19,"Categor\xEDa"),t(),c(20,"input",7),p(21,ee,2,0,"mat-error",5),t(),r(22,"mat-form-field",3)(23,"mat-label"),i(24,"Stock"),t(),c(25,"input",8),p(26,te,2,0,"mat-error",5)(27,oe,2,0,"mat-error",5),t(),r(28,"div",9)(29,"button",10),b("click",function(){return e.cancel()}),i(30,"Cancelar"),t(),r(31,"button",11),i(32),t()()()()()()),s&2){let l,k,g,h,_;a(4),C(e.isEditMode?"Editar Libro":"Nuevo Libro"),a(2),m("formGroup",e.bookForm),a(5),m("ngIf",(l=e.bookForm.get("title"))==null?null:l.hasError("required")),a(5),m("ngIf",(k=e.bookForm.get("author"))==null?null:k.hasError("required")),a(5),m("ngIf",(g=e.bookForm.get("category"))==null?null:g.hasError("required")),a(5),m("ngIf",(h=e.bookForm.get("stock"))==null?null:h.hasError("required")),a(),m("ngIf",(_=e.bookForm.get("stock"))==null?null:_.hasError("min")),a(4),m("disabled",e.bookForm.invalid||e.loading),a(),M(" ",e.loading?"Guardando...":"Guardar"," ")}},dependencies:[F,v,w,q,B,N,y,I,T,D,j,G,P,V,L,H,z,A,R,K,J,U,Q,X],styles:[".form-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:48px 24px 24px;min-height:calc(100vh - 64px);align-items:flex-start}.form-card[_ngcontent-%COMP%]{width:100%;max-width:600px}mat-card-header[_ngcontent-%COMP%]{margin-bottom:24px}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.full-width[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:16px}"]})}return o})();export{Ce as BookFormComponent};
