import{f as l}from"./chunk-72KRNO7Q.js";import{$ as s,P as c,Qc as h,S as i,W as o,j as u,q as n}from"./chunk-PS7QTO7M.js";var m=(()=>{class r{http=s(h);router=s(l);apiUrl="http://localhost:3000/api/auth";currentUserSubject=new u(null);currentUser$=this.currentUserSubject.asObservable();get currentUser(){return this.currentUserSubject.value}get isAuthenticated(){return this.currentUserSubject.value!==null}get isAdmin(){return this.currentUser?.role==="admin"}login(t){return this.http.post(`${this.apiUrl}/login`,t,{withCredentials:!0}).pipe(c(e=>this.getUserProfile().pipe(n(()=>e))))}register(t){return this.http.post(`${this.apiUrl}/register`,t,{withCredentials:!0}).pipe(i(e=>{e.success&&e.user&&this.getUserProfile().subscribe()}))}logout(){return this.http.post(`${this.apiUrl}/logout`,{},{withCredentials:!0}).pipe(i(()=>{this.currentUserSubject.next(null),this.router.navigate(["/auth/login"])}))}getUserProfile(){return this.http.get(`${this.apiUrl}/me`,{withCredentials:!0}).pipe(i(t=>{t.success&&t.user&&this.currentUserSubject.next(t.user)}))}checkAuth(){this.getUserProfile().subscribe({error:()=>this.currentUserSubject.next(null)})}static \u0275fac=function(e){return new(e||r)};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();export{m as a};
